language: java
jdk:
- oraclejdk11
- openjdk8
- openjdk11
dist: bionic
matrix:
   include:
   -  stage: build
      name: Build
      script:
      - sudo apt-get -y install libargon2-0
      - mvn clean install -Pdocker -DskipTests -Dmaven.javadoc.skip=true -B
      - docker-compose build
      services: docker
   -  stage: unit-test
      name: Unit tests
      services: mysql
      script: mvn test -B
      before_install:
      - sudo apt-get -y install libargon2-0
   -  stage: integration-test
      name: Integration tests
      services:
      - mysql
      - docker
      script:
      - mvn verify -DskipUTs=true -DmongoDocker -Dmaven.javadoc.skip=true -B
      - mvn cobertura:cobertura
      before_install:
      - sudo apt-get -y install libargon2-0
      - mvn -Pdocker validate